---
title: 计算 first 和 follow 集
tag:
  - 编译原理
description: 使用各种文法的前提，因此非常重要
---

# {{ $frontmatter.title }}

## 首先讲述文法分析的脉络

我们首先从如何分析文法开始，首先是自顶向下的开始分析，从给定的符号 E 开始，一步步的按照各种给定的文法规则进行拓展，直到得到最终的符号。

但是这个过程中存在很多的问题，我们来一步步的解决

首先遇到的是如何消除二义性，面对具有优先级顺序的符号，我们可以通过改写文法规则二义性。比方说引入新的非终结符 T

其次我们会遇到相同左因子和左递归的问题，前者会造成回溯，后者会造成无限递归，因此我们还需要想办法解决：对于相同左因子，我们可以将其合并后产生新的文法规则，可以一定程度上消除回溯的可能性，但不能解决这个问题，原因是我们此时没有获取更多的信息，只能通过猜测来分析，此时回溯是不可避免的。对于左递归，我们可以改写文法规则来彻底解决，通过引入新的空规则和非终结符。

::: tip
改写文法例子如下

E -> Eα | β

我们可以将其改写为

E -> βE'

E' -> αE' | ε

其通用形式为

E -> Eα<sub>1</sub> | Eα<sub>2</sub> | ... | Eα<sub>n</sub> | β<sub>1</sub> | β<sub>2</sub> | ... | β<sub>m</sub>

我们可以将其改写为

E -> β<sub>1</sub>E'<sub>1</sub> | β<sub>2</sub>E'<sub>2</sub> | ... | β<sub>m</sub>E'<sub>m</sub>

E'<sub>1</sub> -> α<sub>1</sub>E'<sub>1</sub> | ε

E'<sub>2</sub> -> α<sub>2</sub>E'<sub>2</sub> | ε

...

E'<sub>m</sub> -> α<sub>m</sub>E'<sub>m</sub> | ε
:::

接下来我们彻底解决回溯的问题，需要的手段是预测分析，首先看一个没有预测分析文法的例子：S 文法

S 文法是一个简单确定的文法，其规则如下

1. 每个产生式的有不都以终结符开始
2. 同一个非终结符的各个候选式的首终结符都不相同

这个文法要求过于严格，不可以存在空串，如果存在空串并且被迫选择空串，我们没有更多的信息，可能会导致回溯。我们对文法要求进行一次松绑，命名为 q 文法，其要求如下

1. 每个产生式右部都为终结符开始，或者是空串
2. 具有相同左部的产生式的可选集不相交

可以看到第二条规则有一个名词叫做可选集，这意味着我们需要 follow 集和 first 集，这是预测分析的基础。

:::info
LL(1) 文法要求如下

G 的任意两个具有相同左部的产生式 A→α|β 满足下列条件：

1. 如果 α、β 均不能推导出 ε，则 FIRST(α) ∩ FIRST(β) = ∅。
2. 如果 β ═> ε，则 FIRST(α) ∩ FOLLOW(A) = ∅。
3. 如果 α ═> ε，则 FIRST(β) ∩ FOLLOW(A) = ∅。

:::

## 计算 nullable

## 计算 first 集

## 计算 follow 集
